<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8' />
	<meta http-equiv="X-UA-Compatible" content="chrome=1" />
	<meta name="description" content="AAS Time Series library." />
	<title>AAS Time Series example</title>
	<!-- CSS -->
    <link rel="stylesheet" href="resources/aas.css">
    <link rel="stylesheet" href="resources/style.css">
    <script language="javascript" type="text/javascript" src="resources/stuquery.js"></script>
	<script language="javascript" type="text/javascript" src="resources/timeseries.js"></script>
	<script type="text/javascript">
	S(document).ready(function(){
	
		var json = {
			"$schema": "https://vega.github.io/schema/vega/v4.json",
			"width": 800,
			"height": 450,
			"padding": 0,
			"autosize": {"type": "fit", "resize": true},
			"data": [{
				"name": "Danish 1.54m",
				"url": "data/OB110462-danish.csv",
				"format": {"type": "csv", "parse": {"HJD":"number", "dmag":"number", "err":"number"}}
			},{
				"name": "Model",
				"url": "data/OB110462-model.csv",
				"format": {"type": "csv", "parse": {"HJD":"number", "dmag":"number", "err":"number"}}
			}],
			"marks":[{
				"type": "line",
				"from": {"data": "Model"},
				"encode": {
					"enter": {
						"x": {"scale": "xscale", "field": "HJD"},
						"y": {"scale": "yscale", "field": "dmag"},
						"strokeWidth": {"value": 2},
						"strokeDash": {"value":[8,8]},
						"tooltip": {"field": "tooltip"}
					},
					"update": {
						"stroke": {"value": "#999999"},
						"fillOpacity": {"value": 1},
						"zindex": {"value": 0}
					}
				}
			},{
				"type": "rect",
				"from": {"data": "Danish 1.54m"},
				"encode": {
					"enter": {
						"x": {"scale": "xscale", "field": "HJD"},
						"y": {"scale": "yscale", "field": "datum['dmag'] - datum['err']"},
						"y2": {"scale": "yscale", "field": "datum['dmag'] + datum['err']"},
						"width": {"value": 1},
						"fill": {"value": "#000000"}
					},
					"update": {
						"fillOpacity": {"value": 1},
						"fill": {"value": "#000000"},
						"zindex": {"value": 0}
					},
					"hover": {
						"fill": {"value": "#FF7F00"},
						"fillOpacity": {"value": 1},
						"zindex": {"value": 1}
					}
				}
			},{
				"type": "symbol",
				"from": {"data": "Danish 1.54m"},
				"encode": {
					"enter": {
						"x": {"scale": "xscale", "field": "HJD"},
						"y": {"scale": "yscale", "field": "dmag"},
						"shape": {"value": "circle"},
						"tooltip": {"field": "tooltip"}
					},
					"update": {
						"shape": "cross",
						"fill": {"value": "#FF7F00"},
						"fillOpacity": {"value": 1},
						"shape": {"value": "circle"},
						"size": {"value": 4},
						"zindex": {"value": 0}
					},
					"hover": {
						"fill": {"value": "#D60303"},
						"fillOpacity": {"value": 1},
						"shape": {"value": "cross"},
						"size": {"value": 10},
						"zindex": {"value": 1}
					}
				}
			}]
		};

		var ts = S('.timeseries');
		var timeseries = new Array(ts.length);

		for(var i = 0; i < ts.length; i++){
	
			timeseries.push(new TimeSeries({},{'logging':true,'showaswego':false}));

			function interactivate(e){

				e.data.ts.initialize(e.currentTarget);

				// Remove the click event and the toload class
				S(e.currentTarget).off("click").removeClass('toload');
			}
			
			// Add click event to load the interactive graph
			S(ts[i]).addClass('toload').on("click",{ts:timeseries[timeseries.length-1]},interactivate)
		}

		timeseries.push(new TimeSeries(json,{'logging':true,'showaswego':false,'fit':true}));
		S('#fromjson').addClass('toload').on("click",{ts:timeseries[timeseries.length-1]},interactivate);
	});
	</script>
</head>
<body>

	<!-- HEADER -->
	<header>
		<div class="row">
			<div class="padded">
				<a id="forkme_banner" href="https://github.com/astrofrog/aas-time-series-js">Fork Me on GitHub</a>
				<h1 id="project_title">Timeseries</h1>
				<h2 id="project_tagline">An HTML5 timeseries library</h2>
				<p>Last updated: 3 September 2018</p>
			</div>
		</div>
	</header>

	<!-- MAIN CONTENT -->
	<div class="row">
		<div class="large-4 medium-4 columns">
			<div class="panel callout">
				<ul>
					<li><a href="#examples">Examples</a></li>
				</ul>
			</div>
		</div>
		<div class="large-8 medium-8 columns">
			<p>This is some text</p>
		</div>
	</div>
	<div class="bkg-tint">
		<div class="row">
			<section id="examples">
				<h2>Examples</h2>
				<ol>
					<li>
						<h3>Example 1</h3>
						<figure>
							<div id="fromjson" style="width:100%;">
								<img src="data/OB110462-simple-big.png" style="width:100%;" />
							</div>
							<figcaption>An example using inline JSON</figcaption>
						</figure>
					</li>
					<li>
						<h3>Example 2</h3>
						<figure>
							<div class="timeseries" vega-src="data/OB110462-simple.json" vega-scale="inherit">
								<img src="data/OB110462-simple.png" style="width:500px;height:250px;" />
							</div>
							<figcaption>An example using JSON loaded from a file specified by the attribute <code>vega-src</code></figcaption>
						</figure>
					</li>
					<li>
						<h3>Example 3</h3>
						<figure>
							<div class="timeseries" vega-src="data/OB110462.json">
								<img src="data/OB110462.png" style="width:800px;height:450px;" />
							</div>
							<figcaption>This plot represents observations of a gravitational <a href="http://lcogt.net/book-page/gravitational-microlensing">microlensing</a> event. Each data series shows the variation in brightness of the target star as measured by different telescopes in the <a href="http://robonet.lcogt.net/">ROBONET</a> collaboration.</figcaption>
						</figure>
					</li>
				</ol>

			</section>
		</div>
	</div>

	<!-- FOOTER	-->
	<div class="row">
		<footer>
		&copy; 2018
		</footer>
	</div>

	

</body>
</html>
